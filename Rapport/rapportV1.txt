1. Le projet

1.1 Mise en contexte
Nous avons réalisé un système de réservation d’hôtels qui fonctionne en trois parties : le client, une agence de voyage et plusieurs hôtels. Le client ne contacte jamais directement les hôtels. Il envoie ses demandes à l’agence, qui se charge de communiquer avec les différents hôtels pour trouver des offres disponibles et proposer la meilleure option.

Ce fonctionnement reproduit le rôle réel d’une agence de voyage : elle centralise les demandes, interroge plusieurs prestataires et renvoie une réponse unique au client.

1.2 Les technologies et les idées
Le projet est basé sur les technologies suivantes :
- SOAP pour les échanges entre services,
- Java avec le framework Spring Boot pour développer les applications,
- Maven pour gérer le projet et ses dépendances.

L’idée principale est de bien séparer les rôles :
- l’hôtel gère les chambres et les réservations,
- l’agence interroge plusieurs hôtels et rassemble les résultats,
- le client envoie les recherches et les confirmations de réservation.

Cette séparation permet de rendre chaque partie indépendante et réutilisable.

2. L’hôtel

2.1 Logique métier
L’hôtel représente un établissement qui propose des chambres à la réservation.
La logique métier principale tourne autour de quelques notions simples :
les chambres, les dates de séjour, le nombre de personnes et l’état des réservations.

Lorsqu’une demande arrive (dates, ville, nombre de personnes),
l’hôtel vérifie quelles chambres sont libres pour cette période. Si une chambre est disponible, il peut la proposer.
Lorsqu’une réservation est confirmée, l’hôtel bloque la chambre pour les dates demandées afin d’éviter les doublons.

La structure interne peut se représenter par un diagramme de classes classique :
une classe pour l’hôtel, une pour les chambres, une pour les réservations et éventuellement des classes pour les périodes ou les clients. L’objectif est de garder une organisation claire et facile à faire évoluer.

2.2 Implémentation du SOAP
L’hôtel expose un service SOAP qui permet à l’agence de le contacter.
Ce service propose des opérations pour rechercher des chambres disponibles et pour créer une réservation.

Sur le plan technique, l’hôtel définit d’abord un contrat de service à l’aide d’un WSDL (Web Services Description Language) et de schémas XSD. Ces fichiers décrivent de manière formelle la structure des messages (types, champs, formats) et les opérations disponibles (par exemple : rechercherChambres, reserverChambre). Les classes Java utilisées par le service sont générées automatiquement à partir de ces schémas (génération JAXB), ce qui garantit que les objets manipulés côté code correspondent exactement aux messages SOAP échangés.

Le serveur Spring Boot intègre le module Spring-WS, qui publie ce service sur une URL spécifique (un endpoint SOAP). À chaque appel, le message SOAP est reçu, désérialisé en objets Java (unmarshal), puis transmis à une classe de service qui contient la logique métier : vérification des disponibilités, création d’une réservation, mise à jour des listes internes, etc. Une fois le traitement terminé, la réponse est construite sous forme d’objets Java, retransformée en XML SOAP (marshal) et renvoyée au consommateur. L’ensemble suit le contrat défini par le WSDL, ce qui assure l’interopérabilité et la robustesse des échanges.

3. L’agence

3.1 Logique métier
L’agence joue le rôle d’intermédiaire entre le client et les hôtels. Sa logique métier consiste à :
- recevoir une demande de recherche ou de réservation du client,
- interroger plusieurs hôtels,
- rassembler les réponses,
- appliquer éventuellement quelques règles simples (par exemple filtrer par ville, par prix, ou par disponibilité),
- renvoyer au client une réponse unifiée.

Pour une recherche, l’agence envoie la même requête à tous les hôtels concernés. Elle collecte les résultats, les met au même format et les renvoie au client comme si tout venait d’un seul système. Pour une réservation, elle relaie la demande vers l’hôtel choisi.

3.2 Implémentation du SOAP
L’agence expose elle aussi un service SOAP pour communiquer avec le client. Elle est donc à la fois consommatrice de services SOAP (ceux des hôtels) et fournisseuse d’un service SOAP (pour le client).

Concrètement, l’agence publie son propre WSDL qui décrit les opérations offertes au client (recherche de chambres, réservation). Spring Boot et Spring-WS sont utilisés pour configurer un endpoint SOAP qui reçoit les requêtes du client, les transforme en objets Java et invoque la logique métier de l’agence. Pour appeler les hôtels, l’agence utilise des clients SOAP générés à partir des WSDL des différents services hôteliers : ces clients (stubs) se chargent de construire les messages SOAP, d’ouvrir la connexion réseau (HTTP), d’envoyer la requête et de convertir la réponse XML en objets Java.

L’agence joue donc un double rôle : côté « serveur », elle valide les messages entrants, applique ses règles (par exemple agréger les résultats de plusieurs hôtels), et renvoie une réponse structurée ; côté « client », elle consomme les services SOAP des hôtels en respectant leurs contrats WSDL respectifs. Ce découplage permet d’ajouter ou de retirer facilement un hôtel sans modifier le client final, tant que les contrats SOAP restent compatibles.

4. Le client

4.1 Logique métier
Le client représente l’utilisateur final du système. Sa logique métier est volontairement simple : formuler une demande de recherche ou de réservation, envoyer cette demande à l’agence, lire la réponse et éventuellement confirmer une réservation.

Pour simplifier le projet, l’interaction se fait en ligne de commande (CLI). L’utilisateur saisit les informations nécessaires (ville, dates, nombre de personnes, etc.), le client envoie la requête à l’agence puis affiche la réponse.

4.2 Comment ça fonctionne
Le client est une application Spring Boot qui agit comme consommateur du service SOAP de l’agence. Il ne parle qu’avec l’agence, jamais directement avec les hôtels.

Techniquement, le client utilise un proxy SOAP généré à partir du WSDL de l’agence. Ce proxy est un composant Java qui masque les détails du protocole : il sait construire les messages SOAP, gérer le transport HTTP, sérialiser les paramètres et désérialiser les réponses. Spring Boot démarre l’application, configure ce client SOAP (URL du service de l’agence, timeouts, marshaller/unmarshaller JAXB) et permet d’invoquer simplement des méthodes Java au lieu de manipuler directement du XML.

Lorsqu’on lance le client en ligne de commande, une classe de type CLI interagit avec l’utilisateur (lecture des paramètres, choix de l’hôtel, confirmation de la réservation) puis appelle le proxy SOAP de l’agence. La réponse SOAP est transformée en objets métiers (chambres, réservations, messages d’erreur éventuels), puis affichée de manière lisible. Le but est de masquer la complexité technique du SOAP et de proposer une expérience la plus simple possible : l’utilisateur voit uniquement des questions/réponses textuelles, tandis que tous les échanges structurés passent par le service SOAP de l’agence.

5. L’image

5.1 Utilité
L’image sert à rendre l’application plus attractive. Elle illustre un hôtel et aide à donner envie au client de réserver. Même si ce n’est pas indispensable pour la logique métier, c’est important pour l’expérience utilisateur.

5.2 Mise en place
L’image est fournie et servie localement. L’idée est de pouvoir l’afficher depuis le navigateur ou une interface future, en se connectant à l’application via `localhost`. Elle complète le système en apportant un élément visuel simple à intégrer par la suite.

6. Quickstart

Pour faciliter les tests, des scripts sont fournis. Deux fichiers permettent de démarrer rapidement le système : l’un avec un seul hôtel, l’autre avec trois hôtels.

Ces scripts lancent les différentes applications dans le bon ordre. L’utilisateur peut ainsi vérifier le fonctionnement du système dans plusieurs configurations (un hôtel ou plusieurs) sans avoir à tout démarrer manuellement.

7. Évolutions futures

Plusieurs améliorations sont possibles pour faire évoluer ce projet :
- ajouter une véritable interface utilisateur (par exemple une interface web) pour remplacer la ligne de commande,
- connecter le système à une base de données afin de conserver les hôtels, les chambres et les réservations de manière persistante,
- enrichir la logique métier de l’hôtel, par exemple en gérant mieux les cas de concurrence sur les réservations, les annulations ou les modifications de séjour.

Ces évolutions feraient passer le projet d’un prototype pédagogique à un service plus proche d’un système réel.

8. Conclusion

Ce projet montre que SOAP reste une technologie intéressante lorsqu’on a besoin d’échanges fortement typés, avec des contrats bien définis entre services. Les messages sont structurés, validés par des schémas et les interactions sont clairement décrites.

La séparation entre hôtel, agence et client offre une base solide pour un futur service déployable à plus grande échelle. Même si le projet reste simple, il propose déjà une architecture modulaire, extensible et conforme aux principes d’un système distribué.
